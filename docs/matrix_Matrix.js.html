<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Adding favicon -->
    

    <!-- Adding meta -->
    

    <!-- Adding external script-->
    

    <!-- Adding external style-->
    

    <!-- Adding scripts-->
    

    <!-- Adding style-->
    

    <!-- Adding overlay script-->
    

    <!-- Adding overlay style-->
    


    <title>
      matrix/Matrix.js
    </title>

    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/third-party/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/third-party/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/reset.css">
    <link type="text/css" rel="stylesheet" href="styles/clean-jsdoc-theme-base.css">
    <link type="text/css" rel="stylesheet" href="styles/clean-jsdoc-theme-dark.css">
    
    <svg aria-hidden="true" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
    style="display:none">
    <defs>
        <symbol id="copy-icon" viewbox="0 0 488.3 488.3">
            <g>
                <path
                    d="M314.25,85.4h-227c-21.3,0-38.6,17.3-38.6,38.6v325.7c0,21.3,17.3,38.6,38.6,38.6h227c21.3,0,38.6-17.3,38.6-38.6V124    C352.75,102.7,335.45,85.4,314.25,85.4z M325.75,449.6c0,6.4-5.2,11.6-11.6,11.6h-227c-6.4,0-11.6-5.2-11.6-11.6V124    c0-6.4,5.2-11.6,11.6-11.6h227c6.4,0,11.6,5.2,11.6,11.6V449.6z" />
                <path
                    d="M401.05,0h-227c-21.3,0-38.6,17.3-38.6,38.6c0,7.5,6,13.5,13.5,13.5s13.5-6,13.5-13.5c0-6.4,5.2-11.6,11.6-11.6h227    c6.4,0,11.6,5.2,11.6,11.6v325.7c0,6.4-5.2,11.6-11.6,11.6c-7.5,0-13.5,6-13.5,13.5s6,13.5,13.5,13.5c21.3,0,38.6-17.3,38.6-38.6    V38.6C439.65,17.3,422.35,0,401.05,0z" />
            </g>
        </symbol>
        <symbol id='search-icon' viewBox="0 0 512 512">
            <g>
                <g>
                    <path
                        d="M225.474,0C101.151,0,0,101.151,0,225.474c0,124.33,101.151,225.474,225.474,225.474    c124.33,0,225.474-101.144,225.474-225.474C450.948,101.151,349.804,0,225.474,0z M225.474,409.323    c-101.373,0-183.848-82.475-183.848-183.848S124.101,41.626,225.474,41.626s183.848,82.475,183.848,183.848    S326.847,409.323,225.474,409.323z" />
                </g>
            </g>
            <g>
                <g>
                    <path
                        d="M505.902,476.472L386.574,357.144c-8.131-8.131-21.299-8.131-29.43,0c-8.131,8.124-8.131,21.306,0,29.43l119.328,119.328    c4.065,4.065,9.387,6.098,14.715,6.098c5.321,0,10.649-2.033,14.715-6.098C514.033,497.778,514.033,484.596,505.902,476.472z" />
                </g>
            </g>
        </symbol>
        <symbol id="down-icon" viewBox="0 0 16 16">
            <path 
                fill-rule="evenodd" 
                clip-rule="evenodd" 
                d="M12.7803 6.21967C13.0732 6.51256 13.0732 6.98744 12.7803 7.28033L8.53033 11.5303C8.23744 11.8232 7.76256 11.8232 7.46967 11.5303L3.21967 7.28033C2.92678 6.98744 2.92678 6.51256 3.21967 6.21967C3.51256 5.92678 3.98744 5.92678 4.28033 6.21967L8 9.93934L11.7197 6.21967C12.0126 5.92678 12.4874 5.92678 12.7803 6.21967Z"
            >
            </path>
        </symbol>
    </defs>
</svg>
  </head>

  <body>

    <nav class="navbar" id="navbar">
      <div class="navbar-heading" id="navbar-heading"><a href="index.html"><h2 class="navbar-heading-text">Home</h2></a></div><div class="search-box" id="search-box"><div class="search-box-input-container"><input class="search-box-input" type="text" placeholder="Search..." id="search-box-input" /><svg class="search-icon" alt="search-icon"><use xlink:href="#search-icon"></use></svg></div><div class="search-item-container" id="search-item-container"><ul class="search-item-ul" id="search-item-ul"></ul></div></div><div class="sidebar-main-content" id="sidebar-main-content"><div class="accordion collapsed" id="2993684" > <h3 class="accordion-heading">Modules<svg><use xlink:href="#down-icon"></use></svg></h3><ul class="accordion-content"><li class="accordion-list" id=""><a href="module-clustering.html">clustering</a></li><li class="accordion-list" id=""><a href="module-datastructure.html">datastructure</a></li><li class="accordion-list" id=""><a href="module-dimensionality_reduction.html">dimensionality_reduction</a></li><li class="accordion-list" id=""><a href="module-knn.html">knn</a></li><li class="accordion collapsed child" id=5939972><div class="accordion-heading child"><a href="module-linear_algebra.html">linear_algebra</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="module-linear_algebra.html">inner_product</a></li><li data-type='method'><a href="module-linear_algebra.html">poweriteration_n</a></li><li data-type='method'><a href="module-linear_algebra.html">qr</a></li><li data-type='method'><a href="module-linear_algebra.html">qr_givens</a></li><li data-type='method'><a href="module-linear_algebra.html">qr_householder</a></li><li data-type='method'><a href="module-linear_algebra.html">simultaneous_poweriteration</a></li><li data-type='method'><a href="module-linear_algebra.html">svrg</a></li></ul></li><li class="accordion collapsed child" id=7551370><div class="accordion-heading child"><a href="module-matrix.html">matrix</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="module-matrix.html">distance_matrix</a></li><li data-type='method'><a href="module-matrix.html">k_nearest_neigbhors</a></li><li data-type='method'><a href="module-matrix.html">linspace</a></li><li data-type='method'><a href="module-matrix.html">norm</a></li><li data-type='method'><a href="module-matrix.html">normalize</a></li></ul></li><li class="accordion collapsed child" id=6435933><div class="accordion-heading child"><a href="module-metrics.html">metrics</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="module-metrics.html">canberra</a></li><li data-type='method'><a href="module-metrics.html">chebyshev</a></li><li data-type='method'><a href="module-metrics.html">cosine</a></li><li data-type='method'><a href="module-metrics.html">euclidean</a></li><li data-type='method'><a href="module-metrics.html">euclidean_squared</a></li><li data-type='method'><a href="module-metrics.html">hamming</a></li><li data-type='method'><a href="module-metrics.html">jaccard</a></li><li data-type='method'><a href="module-metrics.html">manhattan</a></li><li data-type='method'><a href="module-metrics.html">sokal_michener</a></li><li data-type='method'><a href="module-metrics.html">yule</a></li></ul></li><li class="accordion collapsed child" id=9770226><div class="accordion-heading child"><a href="module-numerical.html">numerical</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="module-numerical.html">kahan_sum</a></li><li data-type='method'><a href="module-numerical.html">neumair_sum</a></li></ul></li><li class="accordion collapsed child" id=4037573><div class="accordion-heading child"><a href="module-optimization.html">optimization</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="module-optimization.html">powell</a></li></ul></li><li class="accordion collapsed child" id=96352><div class="accordion-heading child"><a href="module-utils.html">utils</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="module-utils.html">max</a></li><li data-type='method'><a href="module-utils.html">min</a></li></ul></li></ul> </div><div class="accordion collapsed" id="9019602" > <h3 class="accordion-heading">Classes<svg><use xlink:href="#down-icon"></use></svg></h3><ul class="accordion-content"><li class="accordion collapsed child" id=9096432><div class="accordion-heading child"><a href="BallTree.html">BallTree</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="BallTree.html#add">add</a></li><li data-type='method'><a href="BallTree.html#search">search</a></li></ul></li><li class="accordion-list" id=""><a href="DisjointSet.html">DisjointSet</a></li><li class="accordion collapsed child" id=1528893><div class="accordion-heading child"><a href="DR.html">DR</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="DR.html#p">p</a></li><li data-type='method'><a href="DR.html#p">p</a></li><li data-type='method'><a href="DR.html#para">para</a></li><li data-type='method'><a href="DR.html#para">para</a></li><li data-type='method'><a href="DR.html#parameter">parameter</a></li><li data-type='method'><a href="DR.html#transform">transform</a></li></ul></li><li class="accordion collapsed child" id=771189><div class="accordion-heading child"><a href="FASTMAP.html">FASTMAP</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="FASTMAP.html#parameter">parameter</a></li><li data-type='method'><a href="FASTMAP.html#transform">transform</a></li></ul></li><li class="accordion collapsed child" id=8713794><div class="accordion-heading child"><a href="Heap.html">Heap</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="Heap.html#.heapify">heapify</a></li><li data-type='method'><a href="Heap.html#data">data</a></li><li data-type='method'><a href="Heap.html#iterate">iterate</a></li><li data-type='method'><a href="Heap.html#pop">pop</a></li><li data-type='method'><a href="Heap.html#push">push</a></li><li data-type='method'><a href="Heap.html#raw_data">raw_data</a></li><li data-type='method'><a href="Heap.html#toArray">toArray</a></li></ul></li><li class="accordion collapsed child" id=99181><div class="accordion-heading child"><a href="Hierarchical_Clustering.html">Hierarchical_Clustering</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="Hierarchical_Clustering.html#do">do</a></li><li data-type='method'><a href="Hierarchical_Clustering.html#get_clusters">get_clusters</a></li><li data-type='method'><a href="Hierarchical_Clustering.html#init">init</a></li></ul></li><li class="accordion collapsed child" id=9515221><div class="accordion-heading child"><a href="HIPP.html">HIPP</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="HIPP.html#parameter">parameter</a></li><li data-type='method'><a href="HIPP.html#transform">transform</a></li></ul></li><li class="accordion collapsed child" id=7847764><div class="accordion-heading child"><a href="HNSW.html">HNSW</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="HNSW.html#add">add</a></li><li data-type='method'><a href="HNSW.html#search">search</a></li><li data-type='method'><a href="HNSW.html#search_iter">search_iter</a></li></ul></li><li class="accordion collapsed child" id=4007347><div class="accordion-heading child"><a href="ISOMAP.html">ISOMAP</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="ISOMAP.html#parameter">parameter</a></li><li data-type='method'><a href="ISOMAP.html#transform">transform</a></li></ul></li><li class="accordion collapsed child" id=6931721><div class="accordion-heading child"><a href="KMeans.html">KMeans</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="KMeans.html#get_clusters">get_clusters</a></li><li data-type='method'><a href="KMeans.html#init">init</a></li></ul></li><li class="accordion collapsed child" id=8529887><div class="accordion-heading child"><a href="KMedoids.html">KMedoids</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="KMedoids.html#_get_random_medoids">_get_random_medoids</a></li><li data-type='method'><a href="KMedoids.html#_iteration">_iteration</a></li><li data-type='method'><a href="KMedoids.html#get_clusters">get_clusters</a></li><li data-type='method'><a href="KMedoids.html#init">init</a></li></ul></li><li class="accordion collapsed child" id=9386311><div class="accordion-heading child"><a href="KNN.html">KNN</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="KNN.html#search">search</a></li></ul></li><li class="accordion collapsed child" id=5502622><div class="accordion-heading child"><a href="LDA.html">LDA</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="LDA.html#parameter">parameter</a></li><li data-type='method'><a href="LDA.html#transform">transform</a></li></ul></li><li class="accordion collapsed child" id=1257361><div class="accordion-heading child"><a href="LLE.html">LLE</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="LLE.html#parameter">parameter</a></li><li data-type='method'><a href="LLE.html#transform">transform</a></li></ul></li><li class="accordion collapsed child" id=2473734><div class="accordion-heading child"><a href="LSP.html">LSP</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="LSP.html#init">init</a></li><li data-type='method'><a href="LSP.html#parameter">parameter</a></li><li data-type='method'><a href="LSP.html#transform">transform</a></li></ul></li><li class="accordion collapsed child" id=8632781><div class="accordion-heading child"><a href="LTSA.html">LTSA</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="LTSA.html#parameter">parameter</a></li><li data-type='method'><a href="LTSA.html#transform">transform</a></li></ul></li><li class="accordion collapsed child" id=3410435><div class="accordion-heading child"><a href="Matrix.html">Matrix</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="Matrix.html#.det">det</a></li><li data-type='method'><a href="Matrix.html#.from">from</a></li><li data-type='method'><a href="Matrix.html#.LU">LU</a></li><li data-type='method'><a href="Matrix.html#.solve">solve</a></li><li data-type='method'><a href="Matrix.html#.solve_CG">solve_CG</a></li><li data-type='method'><a href="Matrix.html#.SVD">SVD</a></li><li data-type='method'><a href="Matrix.html#add">add</a></li><li data-type='method'><a href="Matrix.html#clone">clone</a></li><li data-type='method'><a href="Matrix.html#col">col</a></li><li data-type='method'><a href="Matrix.html#concat">concat</a></li><li data-type='method'><a href="Matrix.html#divide">divide</a></li><li data-type='method'><a href="Matrix.html#dot">dot</a></li><li data-type='method'><a href="Matrix.html#entry">entry</a></li><li data-type='method'><a href="Matrix.html#gather">gather</a></li><li data-type='method'><a href="Matrix.html#get_block">get_block</a></li><li data-type='method'><a href="Matrix.html#inverse">inverse</a></li><li data-type='method'><a href="Matrix.html#iterate_rows">iterate_rows</a></li><li data-type='method'><a href="Matrix.html#mult">mult</a></li><li data-type='method'><a href="Matrix.html#outer">outer</a></li><li data-type='method'><a href="Matrix.html#row">row</a></li><li data-type='method'><a href="Matrix.html#set_block">set_block</a></li><li data-type='method'><a href="Matrix.html#set_entry">set_entry</a></li><li data-type='method'><a href="Matrix.html#set_row">set_row</a></li><li data-type='method'><a href="Matrix.html#sub">sub</a></li><li data-type='method'><a href="Matrix.html#transpose">transpose</a></li></ul></li><li class="accordion collapsed child" id=7348109><div class="accordion-heading child"><a href="MDS.html">MDS</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="MDS.html#parameter">parameter</a></li><li data-type='method'><a href="MDS.html#stress">stress</a></li><li data-type='method'><a href="MDS.html#transform">transform</a></li></ul></li><li class="accordion collapsed child" id=1586770><div class="accordion-heading child"><a href="NNDescent.html">NNDescent</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="NNDescent.html#add">add</a></li><li data-type='method'><a href="NNDescent.html#search">search</a></li></ul></li><li class="accordion-list" id=""><a href="OAP.html">OAP</a></li><li class="accordion collapsed child" id=9731852><div class="accordion-heading child"><a href="OPTICS.html">OPTICS</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="OPTICS.html#get_cluster_affirmation">get_cluster_affirmation</a></li><li data-type='method'><a href="OPTICS.html#get_clusters">get_clusters</a></li><li data-type='method'><a href="OPTICS.html#init">init</a></li></ul></li><li class="accordion collapsed child" id=752985><div class="accordion-heading child"><a href="PCA.html">PCA</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="PCA.html#parameter">parameter</a></li><li data-type='method'><a href="PCA.html#principal_components">principal_components</a></li><li data-type='method'><a href="PCA.html#transform">transform</a></li></ul></li><li class="accordion collapsed child" id=2950008><div class="accordion-heading child"><a href="Randomizer.html">Randomizer</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="Randomizer.html#.choice">choice</a></li><li data-type='method'><a href="Randomizer.html#choice">choice</a></li></ul></li><li class="accordion collapsed child" id=9765122><div class="accordion-heading child"><a href="SAMMON.html">SAMMON</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="SAMMON.html#init">init</a></li><li data-type='method'><a href="SAMMON.html#parameter">parameter</a></li><li data-type='method'><a href="SAMMON.html#transform">transform</a></li></ul></li><li class="accordion collapsed child" id=4291125><div class="accordion-heading child"><a href="TopoMap.html">TopoMap</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="TopoMap.html#init">init</a></li><li data-type='method'><a href="TopoMap.html#parameter">parameter</a></li><li data-type='method'><a href="TopoMap.html#transform">transform</a></li></ul></li><li class="accordion collapsed child" id=9523581><div class="accordion-heading child"><a href="TriMap.html">TriMap</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="TriMap.html#_generate_triplets">_generate_triplets</a></li><li data-type='method'><a href="TriMap.html#_grad">_grad</a></li><li data-type='method'><a href="TriMap.html#generator">generator</a></li><li data-type='method'><a href="TriMap.html#init">init</a></li><li data-type='method'><a href="TriMap.html#parameter">parameter</a></li><li data-type='method'><a href="TriMap.html#transform">transform</a></li></ul></li><li class="accordion collapsed child" id=8913463><div class="accordion-heading child"><a href="TSNE.html">TSNE</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="TSNE.html#generator">generator</a></li><li data-type='method'><a href="TSNE.html#init">init</a></li><li data-type='method'><a href="TSNE.html#parameter">parameter</a></li><li data-type='method'><a href="TSNE.html#transform">transform</a></li></ul></li><li class="accordion collapsed child" id=7478228><div class="accordion-heading child"><a href="UMAP.html">UMAP</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="UMAP.html#generator">generator</a></li><li data-type='method'><a href="UMAP.html#init">init</a></li><li data-type='method'><a href="UMAP.html#parameter">parameter</a></li><li data-type='method'><a href="UMAP.html#transform">transform</a></li></ul></li><li class="accordion-list" id=""><a href="XMeans.html">XMeans</a></li></ul> </div><div class="accordion collapsed" id="1088757" > <h3 class="accordion-heading">Global<svg><use xlink:href="#down-icon"></use></svg></h3><ul class="accordion-content"><li class="accordion-list" id=""><a href="global.html#Eigenpair">Eigenpair</a></li></ul> </div>
      

    </nav>
    <div class="navbar-ham" id="navbar-ham">
      <div>
        <div class="first"></div>
        <div class="second"></div>
        <div class="third"></div>
      </div>
    </div>

    <div id="main" class="main-content">
      
      <h1 id='page-title' class="page-title">
        matrix/Matrix.js
      </h1>
      

      



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { neumair_sum } from "../numerical/index.js";
import { simultaneous_poweriteration } from "../linear_algebra/index.js";
import { Randomizer } from "../util/index.js";
/**
 * @class
 * @alias Matrix
 * @requires module:numerical/neumair_sum
 */
export class Matrix {
    /**
     * creates a new Matrix. Entries are stored in a Float64Array.
     * @constructor
     * @memberof module:matrix
     * @alias Matrix
     * @param {number} rows - The amount of rows of the matrix.
     * @param {number} cols - The amount of columns of the matrix.
     * @param {(function|string|number)} value=0 - Can be a function with row and col as parameters, a number, or "zeros", "identity" or "I", or "center".
     *  - **function**: for each entry the function gets called with the parameters for the actual row and column.
     *  - **string**: allowed are
     *      - "zero", creates a zero matrix.
     *      - "identity" or "I", creates an identity matrix.
     *      - "center", creates an center matrix.
     *  - **number**: create a matrix filled with the given value.
     * @example
     *
     * let A = new Matrix(10, 10, () => Math.random()); //creates a 10 times 10 random matrix.
     * let B = new Matrix(3, 3, "I"); // creates a 3 times 3 identity matrix.
     * @returns {Matrix} returns a {@link rows} times {@link cols} Matrix filled with {@link value}.
     */
    constructor(rows = null, cols = null, value = null) {
        this._rows = rows;
        this._cols = cols;
        this._data = null;
        if (rows &amp;&amp; cols) {
            if (!value) {
                this._data = new Float64Array(rows * cols);
                return this;
            }
            if (typeof value === "function") {
                this._data = new Float64Array(rows * cols);
                for (let row = 0; row &lt; rows; ++row) {
                    for (let col = 0; col &lt; cols; ++col) {
                        this._data[row * cols + col] = value(row, col);
                    }
                }
                return this;
            }
            if (typeof value === "string") {
                if (value === "zeros") {
                    return new Matrix(rows, cols, 0);
                }
                if (value === "identity" || value === "I") {
                    this._data = new Float64Array(rows * cols);
                    for (let row = 0; row &lt; rows; ++row) {
                        this._data[row * cols + row] = 1;
                    }
                    return this;
                }
                if (value === "center" &amp;&amp; rows == cols) {
                    this._data = new Float64Array(rows * cols);
                    value = (i, j) => (i === j ? 1 : 0) - 1 / rows;
                    for (let row = 0; row &lt; rows; ++row) {
                        for (let col = 0; col &lt; cols; ++col) {
                            this._data[row * cols + col] = value(row, col);
                        }
                    }
                    return this;
                }
            }
            if (typeof value === "number") {
                this._data = new Float64Array(rows * cols);
                for (let row = 0; row &lt; rows; ++row) {
                    for (let col = 0; col &lt; cols; ++col) {
                        this._data[row * cols + col] = value;
                    }
                }
                return this;
            }
        }
        return this;
    }

    /**
     * Creates a Matrix out of {@link A}.
     * @param {(Matrix|Array|Float64Array|number)} A - The matrix, array, or number, which should converted to a Matrix.
     * @param {"row"|"col"|"diag"} [type = "row"] - If {@link A} is a Array or Float64Array, then type defines if it is a row- or a column vector.
     * @returns {Matrix}
     *
     * @example
     * let A = Matrix.from([[1, 0], [0, 1]]); //creates a two by two identity matrix.
     * let S = Matrix.from([1, 2, 3], "diag"); // creates a 3 by 3 matrix with 1, 2, 3 on its diagonal. [[1, 0, 0], [0, 2, 0], [0, 0, 3]]
     */
    static from(A, type = "row") {
        if (A instanceof Matrix) {
            return A.clone();
        } else if (Array.isArray(A) || A instanceof Float64Array) {
            let m = A.length;
            if (m === 0) throw new Error("Array is empty");
            // 1d
            if (!Array.isArray(A[0]) &amp;&amp; !(A[0] instanceof Float64Array)) {
                if (type === "row") {
                    return new Matrix(1, m, (_, j) => A[j]);
                } else if (type === "col") {
                    return new Matrix(m, 1, (i) => A[i]);
                } else if (type === "diag") {
                    return new Matrix(m, m, (i, j) => (i == j ? A[i] : 0));
                } else {
                    throw new Error("1d array has NaN entries");
                }
                // 2d
            } else if (Array.isArray(A[0]) || A[0] instanceof Float64Array) {
                let n = A[0].length;
                for (let row = 0; row &lt; m; ++row) {
                    if (A[row].length !== n) {
                        throw new Error("various array lengths");
                    }
                }
                return new Matrix(m, n, (i, j) => A[i][j]);
            }
        } else if (typeof A === "number") {
            return new Matrix(1, 1, A);
        } else {
            throw new Error("error");
        }
    }

    /**
     * Returns the {@link row}&lt;sup>th&lt;/sup> row from the Matrix.
     * @param {Number} row
     * @returns {Float64Array}
     */
    row(row) {
        const data = this.values;
        const cols = this._cols;
        return data.subarray(row * cols, (row + 1) * cols);
    }

    /**
     * Returns an generator yielding each row of the Matrix.
     * @yields {Float64Array}
     */
    *iterate_rows() {
        const cols = this._cols;
        const rows = this._rows;
        const data = this.values;
        for (let row = 0; row &lt; rows; ++row) {
            yield data.subarray(row * cols, (row + 1) * cols);
        }
    }

    /**
     * Makes a {@link Matrix} object an iterable object.
     * @yields {Float64Array}
     */
    *[Symbol.iterator]() {
        for (const row of this.iterate_rows()) {
            yield row;
        }
    }

    /**
     * Sets the entries of {@link row}&lt;sup>th&lt;/sup> row from the Matrix to the entries from {@link values}.
     * @param {int} row
     * @param {Array} values
     * @returns {Matrix}
     */
    set_row(row, values) {
        let cols = this._cols;
        if (Array.isArray(values) &amp;&amp; values.length === cols) {
            let offset = row * cols;
            for (let col = 0; col &lt; cols; ++col) {
                this.values[offset + col] = values[col];
            }
        } else if (values instanceof Matrix &amp;&amp; values.shape[1] === cols &amp;&amp; values.shape[0] === 1) {
            let offset = row * cols;
            for (let col = 0; col &lt; cols; ++col) {
                this.values[offset + col] = values._data[col];
            }
        }
        return this;
    }

    /**
     * Returns the {@link col}&lt;sup>th&lt;/sup> column from the Matrix.
     * @param {int} col
     * @returns {Array}
     */
    col(col) {
        let result_col = new Float64Array(this._rows);
        for (let row = 0; row &lt; this._rows; ++row) {
            result_col[row] = this.values[row * this._cols + col];
        }
        return result_col;
    }

    /**
     * Returns the {@link col}&lt;sup>th&lt;/sup> entry from the {@link row}&lt;sup>th&lt;/sup> row of the Matrix.
     * @param {int} row
     * @param {int} col
     * @returns {float64}
     */
    entry(row, col) {
        return this.values[row * this._cols + col];
    }

    /**
     * Sets the {@link col}&lt;sup>th&lt;/sup> entry from the {@link row}&lt;sup>th&lt;/sup> row of the Matrix to the given {@link value}.
     * @param {int} row
     * @param {int} col
     * @param {float64} value
     * @returns {Matrix}
     */
    set_entry(row, col, value) {
        this.values[row * this._cols + col] = value;
        return this;
    }

    /**
     * Returns a new transposed Matrix.
     * @returns {Matrix}
     */
    transpose() {
        let B = new Matrix(this._cols, this._rows, (row, col) => this.entry(col, row));
        return B;
    }

    /**
     * Returns a new transposed Matrix. Short-form of {@function transpose}.
     * @returns {Matrix}
     */
    get T() {
        return this.transpose();
    }

    /**
     * Returns the inverse of the Matrix.
     * @returns {Matrix}
     */
    inverse() {
        const rows = this._rows;
        const cols = this._cols;
        let B = new Matrix(rows, 2 * cols, (i, j) => {
            if (j >= cols) {
                return i === j - cols ? 1 : 0;
            } else {
                return this.entry(i, j);
            }
        });
        let h = 0;
        let k = 0;
        while (h &lt; rows &amp;&amp; k &lt; cols) {
            var i_max = 0;
            let max_val = -Infinity;
            for (let i = h; i &lt; rows; ++i) {
                let val = Math.abs(B.entry(i, k));
                if (max_val &lt; val) {
                    i_max = i;
                    max_val = val;
                }
            }
            if (B.entry(i_max, k) == 0) {
                k++;
            } else {
                // swap rows
                for (let j = 0; j &lt; 2 * cols; ++j) {
                    let h_val = B.entry(h, j);
                    let i_val = B.entry(i_max, j);
                    B.set_entry(h, j, h_val);
                    B.set_entry(i_max, j, i_val);
                }
                for (let i = h + 1; i &lt; rows; ++i) {
                    let f = B.entry(i, k) / B.entry(h, k);
                    B.set_entry(i, k, 0);
                    for (let j = k + 1; j &lt; 2 * cols; ++j) {
                        B.set_entry(i, j, B.entry(i, j) - B.entry(h, j) * f);
                    }
                }
                h++;
                k++;
            }
        }

        for (let row = 0; row &lt; rows; ++row) {
            let f = B.entry(row, row);
            for (let col = row; col &lt; 2 * cols; ++col) {
                B.set_entry(row, col, B.entry(row, col) / f);
            }
        }

        for (let row = rows - 1; row >= 0; --row) {
            let B_row_row = B.entry(row, row);
            for (let i = 0; i &lt; row; i++) {
                let B_i_row = B.entry(i, row);
                let f = B_i_row / B_row_row;
                for (let j = i; j &lt; 2 * cols; ++j) {
                    let B_i_j = B.entry(i, j);
                    let B_row_j = B.entry(row, j);
                    B_i_j = B_i_j - B_row_j * f;
                    B.set_entry(i, j, B_i_j);
                }
            }
        }

        return new Matrix(rows, cols, (i, j) => B.entry(i, j + cols));
    }

    /**
     * Returns the dot product. If {@link B} is an Array or Float64Array then an Array gets returned. If {@link B} is a Matrix then a Matrix gets returned.
     * @param {(Matrix|Array|Float64Array)} B the right side
     * @returns {(Matrix|Array)}
     */
    dot(B) {
        if (B instanceof Matrix) {
            let A = this;
            if (A.shape[1] !== B.shape[0]) {
                throw new Error(`A.dot(B): A is a ${A.shape.join(" тип ")}-Matrix, B is a ${B.shape.join(" тип ")}-Matrix: 
                A has ${A.shape[1]} cols and B ${B.shape[0]} rows. 
                Must be equal!`);
            }
            let I = A.shape[1];
            let C = new Matrix(A.shape[0], B.shape[1], (row, col) => {
                const A_i = A.row(row);
                const B_i = B.col(col);
                let sum = 0;
                for (let i = 0; i &lt; I; ++i) {
                    sum += A_i[i] * B_i[i];
                }
                return sum;
            });
            return C;
        } else if (Array.isArray(B) || B instanceof Float64Array) {
            let rows = this._rows;
            if (B.length !== rows) {
                throw new Error(`A.dot(B): A has ${rows} cols and B has ${B.length} rows. Must be equal!`);
            }
            let C = new Array(rows);
            for (let row = 0; row &lt; rows; ++row) {
                C[row] = neumair_sum(this.row(row).map((e) => e * B[row]));
            }
            return C;
        } else {
            throw new Error(`B must be Matrix or Array`);
        }
    }

    /**
     * Computes the outer product from {@link this} and {@link B}.
     * @param {Matrix} B
     * @returns {Matrix}
     */
    outer(B) {
        let A = this;
        let l = A._data.length;
        let r = B._data.length;
        if (l != r) return undefined;
        let C = new Matrix();
        C.shape = [
            l,
            l,
            (i, j) => {
                if (i &lt;= j) {
                    return A._data[i] * B._data[j];
                } else {
                    return C.entry(j, i);
                }
            },
        ];
        return C;
    }

    /**
     * Appends matrix {@link B} to the matrix.
     * @param {Matrix} B - matrix to append.
     * @param {"horizontal"|"vertical"|"diag"} [type = "horizontal"] - type of concatenation.
     * @returns {Matrix}
     * @example
     *
     * let A = Matrix.from([[1, 1], [1, 1]]); // 2 by 2 matrix filled with ones.
     * let B = Matrix.from([[2, 2], [2, 2]]); // 2 by 2 matrix filled with twos.
     *
     * A.concat(B, "horizontal"); // 2 by 4 matrix. [[1, 1, 2, 2], [1, 1, 2, 2]]
     * A.concat(B, "vertical"); // 4 by 2 matrix. [[1, 1], [1, 1], [2, 2], [2, 2]]
     * A.concat(B, "diag"); // 4 by 4 matrix. [[1, 1, 0, 0], [1, 1, 0, 0], [0, 0, 2, 2], [0, 0, 2, 2]]
     */
    concat(B, type = "horizontal") {
        const A = this;
        const [rows_A, cols_A] = A.shape;
        const [rows_B, cols_B] = B.shape;
        if (type == "horizontal") {
            if (rows_A != rows_B) {
                throw new Error(`A.concat(B, "horizontal"): A and B need same number of rows, A has ${rows_A} rows, B has ${rows_B} rows.`);
            }
            const X = new Matrix(rows_A, cols_A + cols_B, "zeros");
            X.set_block(0, 0, A);
            X.set_block(0, cols_A, B);
            return X;
        } else if (type == "vertical") {
            if (cols_A != cols_B) {
                throw new Error(`A.concat(B, "vertical"): A and B need same number of columns, A has ${cols_A} columns, B has ${cols_B} columns.`);
            }
            const X = new Matrix(rows_A + rows_B, cols_A, "zeros");
            X.set_block(0, 0, A);
            X.set_block(rows_A, 0, B);
            return X;
        } else if (type == "diag") {
            const X = new Matrix(rows_A + rows_B, cols_A + cols_B, "zeros");
            X.set_block(0, 0, A);
            X.set_block(rows_A, cols_A, B);
            return X;
        } else {
            throw new Error(`type must be "horizontal" or "vertical", but type is ${type}!`);
        }
    }

    /**
     * Writes the entries of B in A at an offset position given by {@link offset_row} and {@link offset_col}.
     * @param {int} offset_row
     * @param {int} offset_col
     * @param {Matrix} B
     * @returns {Matrix}
     */
    set_block(offset_row, offset_col, B) {
        let [rows, cols] = B.shape;
        for (let row = 0; row &lt; rows; ++row) {
            if (row > this._rows) {
                continue;
            }
            for (let col = 0; col &lt; cols; ++col) {
                if (col > this._cols) {
                    continue;
                }
                this.set_entry(row + offset_row, col + offset_col, B.entry(row, col));
            }
        }
        return this;
    }

    /**
     * Extracts the entries from the {@link start_row}&lt;sup>th&lt;/sup> row to the {@link end_row}&lt;sup>th&lt;/sup> row, the {@link start_col}&lt;sup>th&lt;/sup> column to the {@link end_col}&lt;sup>th&lt;/sup> column of the matrix.
     * If {@link end_row} or {@link end_col} is empty, the respective value is set to {@link this.rows} or {@link this.cols}.
     * @param {Number} start_row
     * @param {Number} start_col
     * @param {Number} [end_row = null]
     * @param {Number} [end_col = null]
     * @returns {Matrix} Returns a end_row - start_row times end_col - start_col matrix, with respective entries from the matrix.
     * @example
     *
     * let A = Matrix.from([[1, 2, 3], [4, 5, 6], [7, 8, 9]]); // a 3 by 3 matrix.
     *
     * A.get_block(1, 1); // [[5, 6], [8, 9]]
     * A.get_block(0, 0, 1, 1); // [[1]]
     * A.get_block(1, 1, 2, 2); // [[5]]
     * A.get_block(0, 0, 2, 2); // [[1, 2], [4, 5]]
     */
    get_block(start_row, start_col, end_row = null, end_col = null) {
        const [rows, cols] = this.shape;
        end_row = end_row ?? rows;
        end_col = end_col ?? cols;
        if (end_row &lt;= start_row || end_col &lt;= start_col) {
            throw new Error(`
                end_row must be greater than start_row, and 
                end_col must be greater than start_col, but
                end_row = ${end_row}, start_row = ${start_row}, end_col = ${end_col}, and start_col = ${start_col}!`);
        }
        const X = new Matrix(end_row - start_row, end_col - start_col, "zeros");
        for (let row = start_row, new_row = 0; row &lt; end_row; ++row, ++new_row) {
            for (let col = start_col, new_col = 0; col &lt; end_col; ++col, ++new_col) {
                X.set_entry(new_row, new_col, this.entry(row, col));
            }
        }
        return X;
        //return new Matrix(end_row - start_row, end_col - start_col, (i, j) => this.entry(i + start_row, j + start_col));
    }

    /**
     * Returns a new array gathering entries defined by the indices given by argument.
     * @param {Array&lt;Number>} row_indices - Array consists of indices of rows for gathering entries of this matrix
     * @param {Array&lt;Number>} col_indices  - Array consists of indices of cols for gathering entries of this matrix
     * @returns {Matrix}
     */
    gather(row_indices, col_indices) {
        const N = row_indices.length;
        const D = col_indices.length;

        const R = new Matrix(N, D);
        for (let i = 0; i &lt; N; ++i) {
            const row_index = row_indices[i];
            for (let j = 0; j &lt; N; ++j) {
                const col_index = col_indices[j];
                R.set_entry(i, j, this.entry(row_index, col_index));
            }
        }

        return R;
    }

    /**
     * Applies a function to each entry of the matrix.
     * @private
     * @param {function} f function takes 2 parameters, the value of the actual entry and a value given by the function {@link v}. The result of {@link f} gets writen to the Matrix.
     * @param {function} v function takes 2 parameters for row and col, and returns a value witch should be applied to the colth entry of the rowth row of the matrix.
     */
    _apply_array(f, v) {
        const data = this.values;
        const [rows, cols] = this.shape;
        for (let row = 0; row &lt; rows; ++row) {
            const offset = row * cols;
            for (let col = 0; col &lt; cols; ++col) {
                const i = offset + col;
                data[i] = f(data[i], v(row, col));
            }
        }
        return this;
    }

    _apply_rowwise_array(values, f) {
        return this._apply_array(f, (_, j) => values[j]);
    }

    _apply_colwise_array(values, f) {
        const data = this.values;
        const [rows, cols] = this.shape;
        for (let row = 0; row &lt; rows; ++row) {
            const offset = row * cols;
            for (let col = 0; col &lt; cols; ++col) {
                const i = offset + col;
                data[i] = f(data[i], values[row]);
            }
        }
        return this;
    }

    _apply(value, f) {
        let data = this.values;
        if (value instanceof Matrix) {
            let [value_rows, value_cols] = value.shape;
            let [rows, cols] = this.shape;
            if (value_rows === 1) {
                if (cols !== value_cols) {
                    throw new Error(`cols !== value_cols`);
                }
                for (let row = 0; row &lt; rows; ++row) {
                    for (let col = 0; col &lt; cols; ++col) {
                        data[row * cols + col] = f(data[row * cols + col], value.entry(0, col));
                    }
                }
            } else if (value_cols === 1) {
                if (rows !== value_rows) {
                    throw new Error(`rows !== value_rows`);
                }
                for (let row = 0; row &lt; rows; ++row) {
                    for (let col = 0; col &lt; cols; ++col) {
                        data[row * cols + col] = f(data[row * cols + col], value.entry(row, 0));
                    }
                }
            } else if (rows == value_rows &amp;&amp; cols == value_cols) {
                for (let row = 0; row &lt; rows; ++row) {
                    for (let col = 0; col &lt; cols; ++col) {
                        data[row * cols + col] = f(data[row * cols + col], value.entry(row, col));
                    }
                }
            } else {
                throw new Error(`error`);
            }
        } else if (Array.isArray(value)) {
            let rows = this._rows;
            let cols = this._cols;
            if (value.length === rows) {
                for (let row = 0; row &lt; rows; ++row) {
                    for (let col = 0; col &lt; cols; ++col) {
                        data[row * cols + col] = f(data[row * cols + col], value[row]);
                    }
                }
            } else if (value.length === cols) {
                for (let row = 0; row &lt; rows; ++row) {
                    for (let col = 0; col &lt; cols; ++col) {
                        data[row * cols + col] = f(data[row * cols + col], value[col]);
                    }
                }
            } else {
                throw new Error(`error`);
            }
        } else {
            for (let i = 0, n = this._rows * this._cols; i &lt; n; ++i) {
                data[i] = f(data[i], value);
            }
        }
        return this;
    }

    /**
     * Clones the Matrix.
     * @returns {Matrix}
     */
    clone() {
        let B = new Matrix();
        B._rows = this._rows;
        B._cols = this._cols;
        B._data = this.values.slice(0);
        return B;
    }

    /**
     * Entrywise multiplication with {@link value}.
     * @param {Matrix|Array|Number} value
     * @returns {Matrix}
     * @example
     *
     * let A = Matrix.from([[1, 2], [3, 4]]); // a 2 by 2 matrix.
     * let B = A.clone(); // B == A;
     *
     * A.mult(2); // [[2, 4], [6, 8]];
     * A.mult(B); // [[1, 4], [9, 16]];
     */
    mult(value) {
        return this.clone()._apply(value, (a, b) => a * b);
    }

    /**
     * Entrywise division with {@link value}.
     * @param {Matrix|Array|Number} value
     * @returns {Matrix}
     * @example
     *
     * let A = Matrix.from([[1, 2], [3, 4]]); // a 2 by 2 matrix.
     * let B = A.clone(); // B == A;
     *
     * A.divide(2); // [[0.5, 1], [1.5, 2]];
     * A.divide(B); // [[1, 1], [1, 1]];
     */
    divide(value) {
        return this.clone()._apply(value, (a, b) => a / b);
    }

    /**
     * Entrywise addition with {@link value}.
     * @param {Matrix|Array|Number} value
     * @returns {Matrix}
     * @example
     *
     * let A = Matrix.from([[1, 2], [3, 4]]); // a 2 by 2 matrix.
     * let B = A.clone(); // B == A;
     *
     * A.add(2); // [[3, 4], [5, 6]];
     * A.add(B); // [[2, 4], [6, 8]];
     */
    add(value) {
        return this.clone()._apply(value, (a, b) => a + b);
    }

    /**
     * Entrywise subtraction with {@link value}.
     * @param {Matrix|Array|Number} value
     * @returns {Matrix}
     * @example
     *
     * let A = Matrix.from([[1, 2], [3, 4]]); // a 2 by 2 matrix.
     * let B = A.clone(); // B == A;
     *
     * A.sub(2); // [[-1, 0], [1, 2]];
     * A.sub(B); // [[0, 0], [0, 0]];
     */
    sub(value) {
        return this.clone()._apply(value, (a, b) => a - b);
    }

    /**
     * Returns the number of rows and columns of the Matrix.
     * @returns {Array} An Array in the form [rows, columns].
     */
    get shape() {
        return [this._rows, this._cols];
    }

    /**
     * Returns the matrix in the given shape with the given function which returns values for the entries of the matrix.
     * @param {Array} parameter - takes an Array in the form [rows, cols, value], where rows and cols are the number of rows and columns of the matrix, and value is a function which takes two parameters (row and col) which has to return a value for the colth entry of the rowth row.
     * @returns {Matrix}
     */
    set shape([rows, cols, value = () => 0]) {
        this._rows = rows;
        this._cols = cols;
        this._data = new Float64Array(rows * cols);
        for (let row = 0; row &lt; rows; ++row) {
            for (let col = 0; col &lt; cols; ++col) {
                this._data[row * cols + col] = value(row, col);
            }
        }
        return this;
    }

    /**
     * Returns the Matrix as a Array of Float64Arrays.
     * @returns {Array&lt;Float64Array>}
     */
    get to2dArray() {
        const result = [];
        for (const row of this.iterate_rows()) {
            result.push(row);
        }
        return result;
    }

    /**
     * Returns the Matrix as a Array of Arrays.
     * @returns {Array&lt;Array>}
     */
    get asArray() {
        const result = [];
        for (const row of this.iterate_rows()) {
            result.push(Array.from(row));
        }
        return result;
    }

    /**
     * Returns the diagonal of the Matrix.
     * @returns {Float64Array}
     */
    get diag() {
        const rows = this._rows;
        const cols = this._cols;
        const min_row_col = Math.min(rows, cols);
        let result = new Float64Array(min_row_col);
        for (let i = 0; i &lt; min_row_col; ++i) {
            result[i] = this.entry(i, i);
        }
        return result;
    }

    /**
     * Returns the mean of all entries of the Matrix.
     * @returns {Number}
     */
    get mean() {
        const sum = this.sum;
        const n = this._rows * this._cols;
        return sum / n;
    }

    /**
     * Returns the sum oof all entries of the Matrix.
     * @returns {Number}
     */
    get sum() {
        const data = this.values;
        return neumair_sum(data);
    }

    /**
     * Returns the sum oof all entries of the Matrix.
     * @returns {Float64Array}
     */
    get values() {
        const data = this._data;
        return data;
    }

    /**
     * Returns the mean of each row of the matrix.
     * @returns {Float64Array}
     */
    get meanRows() {
        const data = this.values;
        const rows = this._rows;
        const cols = this._cols;
        const result = Float64Array.from({ length: rows });
        for (let row = 0; row &lt; rows; ++row) {
            result[row] = 0;
            for (let col = 0; col &lt; cols; ++col) {
                result[row] += data[row * cols + col];
            }
            result[row] /= cols;
        }
        return result;
    }

    /** Returns the mean of each column of the matrix.
     * @returns {Float64Array}
     */
    get meanCols() {
        const data = this.values;
        const rows = this._rows;
        const cols = this._cols;
        const result = Float64Array.from({ length: cols });
        for (let col = 0; col &lt; cols; ++col) {
            result[col] = 0;
            for (let row = 0; row &lt; rows; ++row) {
                result[col] += data[row * cols + col];
            }
            result[col] /= rows;
        }
        return result;
    }

    /**
     * Solves the equation {@link A}x = {@link b} using the conjugate gradient method. Returns the result x.
     * @param {Matrix} A - Matrix
     * @param {Matrix} b - Matrix
     * @param {Randomizer} [randomizer=null]
     * @param {Number} [tol=1e-3]
     * @returns {Matrix}
     */
    static solve_CG(A, b, randomizer, tol = 1e-3) {
        if (randomizer === null) {
            randomizer = new Randomizer();
        }
        const rows = A.shape[0];
        const cols = b.shape[1];
        let result = new Matrix(rows, 0);
        for (let i = 0; i &lt; cols; ++i) {
            const b_i = Matrix.from(b.col(i)).T;
            let x = new Matrix(rows, 1, () => randomizer.random);
            let r = b_i.sub(A.dot(x));
            let d = r.clone();
            do {
                const z = A.dot(d);
                const alpha = r.T.dot(r).entry(0, 0) / d.T.dot(z).entry(0, 0);
                x = x.add(d.mult(alpha));
                const r_next = r.sub(z.mult(alpha));
                const beta = r_next.T.dot(r_next).entry(0, 0) / r.T.dot(r).entry(0, 0);
                d = r_next.add(d.mult(beta));
                r = r_next;
            } while (Math.abs(r.mean) > tol);
            result = result.concat(x, "horizontal");
        }
        return result;
    }

    /**
     * Solves the equation {@link A}x = {@link b}. Returns the result x.
     * @param {Matrix} A - Matrix or LU Decomposition
     * @param {Matrix} b - Matrix
     * @returns {Matrix}
     */
    static solve(A, b) {
        let { L: L, U: U } = "L" in A &amp;&amp; "U" in A ? A : Matrix.LU(A);
        let rows = L.shape[0];
        let x = b.clone();

        // forward
        for (let row = 0; row &lt; rows; ++row) {
            for (let col = 0; col &lt; row - 1; ++col) {
                x.set_entry(0, row, x.entry(0, row) - L.entry(row, col) * x.entry(1, col));
            }
            x.set_entry(0, row, x.entry(0, row) / L.entry(row, row));
        }

        // backward
        for (let row = rows - 1; row >= 0; --row) {
            for (let col = rows - 1; col > row; --col) {
                x.set_entry(0, row, x.entry(0, row) - U.entry(row, col) * x.entry(0, col));
            }
            x.set_entry(0, row, x.entry(0, row) / U.entry(row, row));
        }

        return x;
    }

    /**
     * {@link L}{@link U} decomposition of the Matrix {@link A}. Creates two matrices, so that the dot product LU equals A.
     * @param {Matrix} A
     * @returns {{L: Matrix, U: Matrix}} result - Returns the left triangle matrix {@link L} and the upper triangle matrix {@link U}.
     */
    static LU(A) {
        const rows = A.shape[0];
        const L = new Matrix(rows, rows, "zeros");
        const U = new Matrix(rows, rows, "identity");

        for (let j = 0; j &lt; rows; ++j) {
            for (let i = j; i &lt; rows; ++i) {
                let sum = 0;
                for (let k = 0; k &lt; j; ++k) {
                    sum += L.entry(i, k) * U.entry(k, j);
                }
                L.set_entry(i, j, A.entry(i, j) - sum);
            }
            for (let i = j; i &lt; rows; ++i) {
                if (L.entry(j, j) === 0) {
                    return undefined;
                }
                let sum = 0;
                for (let k = 0; k &lt; j; ++k) {
                    sum += L.entry(j, k) * U.entry(k, i);
                }
                U.set_entry(j, i, (A.entry(j, i) - sum) / L.entry(j, j));
            }
        }

        return { L: L, U: U };
    }

    /**
     * Computes the determinante of {@link A}, by using the LU decomposition of {@link A}.
     * @param {Matrix} A
     * @returns {Number} det - Returns the determinate of the Matrix {@link A}.
     */
    static det(A) {
        const rows = A.shape[0];
        const { L, U } = Matrix.LU(A);
        const L_diag = L.diag;
        const U_diag = U.diag;
        let det = L_diag[0] * U_diag[0];
        for (let row = 1; row &lt; rows; ++row) {
            det *= L_diag[row] * U_diag[row];
        }
        return det;
    }

    /**
     * Computes the {@link k} components of the SVD decomposition of the matrix {@link M}
     * @param {Matrix} M
     * @param {int} [k=2]
     * @returns {{U: Matrix, Sigma: Matrix, V: Matrix}}
     */
    static SVD(M, k = 2) {
        const MT = M.T;
        let MtM = MT.dot(M);
        let MMt = M.dot(MT);
        let { eigenvectors: V, eigenvalues: Sigma } = simultaneous_poweriteration(MtM, k);
        let { eigenvectors: U } = simultaneous_poweriteration(MMt, k);
        return { U: U, Sigma: Sigma.map((sigma) => Math.sqrt(sigma)), V: V };

        //Algorithm 1a: Householder reduction to bidiagonal form:
        /* const [m, n] = A.shape;
        let U = new Matrix(m, n, (i, j) => i == j ? 1 : 0);
        console.log(U.to2dArray)
        let V = new Matrix(n, m, (i, j) => i == j ? 1 : 0);
        console.log(V.to2dArray)
        let B = Matrix.bidiagonal(A.clone(), U, V);
        console.log(U,V,B)
        return { U: U, "Sigma": B, V: V }; */
    }
}
</code></pre>
        </article>
    </section>




    </div>

    <footer class="footer" id="footer">
      
    </footer>

    <script src="scripts/third-party/prettify.js"></script>
    <script src="scripts/third-party/lang-css.js"></script>
    <script type="text/javascript" src="scripts/misc.js"></script>

    <script>prettyPrint();</script>
    <script src="scripts/linenumber.js"></script>
    <script src="scripts/fix-code-block.js"></script>
    <script src="scripts/fix-navbar.js"></script>
    
      <script src="scripts/search.js"></script>
      <script src="scripts/third-party/fuse.js"></script>
      <script>
        var list = [{"title":"clustering","link":"<a href=\"module-clustering.html\">clustering</a>"},{"title":"datastructure","link":"<a href=\"module-datastructure.html\">datastructure</a>"},{"title":"dimensionality_reduction","link":"<a href=\"module-dimensionality_reduction.html\">dimensionality_reduction</a>"},{"title":"knn","link":"<a href=\"module-knn.html\">knn</a>"},{"title":"linear_algebra","link":"<a href=\"module-linear_algebra.html\">linear_algebra</a>"},{"title":"inner_product","link":"<a href=\"module-linear_algebra.html\">inner_product &rtrif; undefined</a>"},{"title":"poweriteration_n","link":"<a href=\"module-linear_algebra.html\">poweriteration_n &rtrif; undefined</a>"},{"title":"qr","link":"<a href=\"module-linear_algebra.html\">qr &rtrif; undefined</a>"},{"title":"qr_givens","link":"<a href=\"module-linear_algebra.html\">qr_givens &rtrif; undefined</a>"},{"title":"qr_householder","link":"<a href=\"module-linear_algebra.html\">qr_householder &rtrif; undefined</a>"},{"title":"simultaneous_poweriteration","link":"<a href=\"module-linear_algebra.html\">simultaneous_poweriteration &rtrif; undefined</a>"},{"title":"svrg","link":"<a href=\"module-linear_algebra.html\">svrg &rtrif; undefined</a>"},{"title":"matrix","link":"<a href=\"module-matrix.html\">matrix</a>"},{"title":"distance_matrix","link":"<a href=\"module-matrix.html\">distance_matrix &rtrif; undefined</a>"},{"title":"k_nearest_neigbhors","link":"<a href=\"module-matrix.html\">k_nearest_neigbhors &rtrif; undefined</a>"},{"title":"linspace","link":"<a href=\"module-matrix.html\">linspace &rtrif; undefined</a>"},{"title":"norm","link":"<a href=\"module-matrix.html\">norm &rtrif; undefined</a>"},{"title":"normalize","link":"<a href=\"module-matrix.html\">normalize &rtrif; undefined</a>"},{"title":"metrics","link":"<a href=\"module-metrics.html\">metrics</a>"},{"title":"canberra","link":"<a href=\"module-metrics.html\">canberra &rtrif; undefined</a>"},{"title":"chebyshev","link":"<a href=\"module-metrics.html\">chebyshev &rtrif; undefined</a>"},{"title":"cosine","link":"<a href=\"module-metrics.html\">cosine &rtrif; undefined</a>"},{"title":"euclidean","link":"<a href=\"module-metrics.html\">euclidean &rtrif; undefined</a>"},{"title":"euclidean_squared","link":"<a href=\"module-metrics.html\">euclidean_squared &rtrif; undefined</a>"},{"title":"hamming","link":"<a href=\"module-metrics.html\">hamming &rtrif; undefined</a>"},{"title":"jaccard","link":"<a href=\"module-metrics.html\">jaccard &rtrif; undefined</a>"},{"title":"manhattan","link":"<a href=\"module-metrics.html\">manhattan &rtrif; undefined</a>"},{"title":"sokal_michener","link":"<a href=\"module-metrics.html\">sokal_michener &rtrif; undefined</a>"},{"title":"yule","link":"<a href=\"module-metrics.html\">yule &rtrif; undefined</a>"},{"title":"numerical","link":"<a href=\"module-numerical.html\">numerical</a>"},{"title":"kahan_sum","link":"<a href=\"module-numerical.html\">kahan_sum &rtrif; undefined</a>"},{"title":"neumair_sum","link":"<a href=\"module-numerical.html\">neumair_sum &rtrif; undefined</a>"},{"title":"optimization","link":"<a href=\"module-optimization.html\">optimization</a>"},{"title":"powell","link":"<a href=\"module-optimization.html\">powell &rtrif; undefined</a>"},{"title":"utils","link":"<a href=\"module-utils.html\">utils</a>"},{"title":"max","link":"<a href=\"module-utils.html\">max &rtrif; undefined</a>"},{"title":"min","link":"<a href=\"module-utils.html\">min &rtrif; undefined</a>"},{"title":"BallTree","link":"<a href=\"BallTree.html\">BallTree</a>"},{"title":"BallTree#add","link":"<a href=\"BallTree.html#add\">BallTree &rtrif; add</a>"},{"title":"BallTree#search","link":"<a href=\"BallTree.html#search\">BallTree &rtrif; search</a>"},{"title":"DisjointSet","link":"<a href=\"DisjointSet.html\">DisjointSet</a>"},{"title":"DR","link":"<a href=\"DR.html\">DR</a>"},{"title":"DR#p","link":"<a href=\"DR.html#p\">DR &rtrif; p</a>"},{"title":"DR#p","link":"<a href=\"DR.html#p\">DR &rtrif; p</a>"},{"title":"DR#para","link":"<a href=\"DR.html#para\">DR &rtrif; para</a>"},{"title":"DR#para","link":"<a href=\"DR.html#para\">DR &rtrif; para</a>"},{"title":"DR#parameter","link":"<a href=\"DR.html#parameter\">DR &rtrif; parameter</a>"},{"title":"DR#transform","link":"<a href=\"DR.html#transform\">DR &rtrif; transform</a>"},{"title":"FASTMAP","link":"<a href=\"FASTMAP.html\">FASTMAP</a>"},{"title":"FASTMAP#parameter","link":"<a href=\"FASTMAP.html#parameter\">FASTMAP &rtrif; parameter</a>"},{"title":"FASTMAP#transform","link":"<a href=\"FASTMAP.html#transform\">FASTMAP &rtrif; transform</a>"},{"title":"Heap","link":"<a href=\"Heap.html\">Heap</a>"},{"title":"Heap.heapify","link":"<a href=\"Heap.html#.heapify\">Heap.heapify &rtrif; undefined</a>"},{"title":"Heap#data","link":"<a href=\"Heap.html#data\">Heap &rtrif; data</a>"},{"title":"Heap#iterate","link":"<a href=\"Heap.html#iterate\">Heap &rtrif; iterate</a>"},{"title":"Heap#pop","link":"<a href=\"Heap.html#pop\">Heap &rtrif; pop</a>"},{"title":"Heap#push","link":"<a href=\"Heap.html#push\">Heap &rtrif; push</a>"},{"title":"Heap#raw_data","link":"<a href=\"Heap.html#raw_data\">Heap &rtrif; raw_data</a>"},{"title":"Heap#toArray","link":"<a href=\"Heap.html#toArray\">Heap &rtrif; toArray</a>"},{"title":"Hierarchical_Clustering","link":"<a href=\"Hierarchical_Clustering.html\">Hierarchical_Clustering</a>"},{"title":"Hierarchical_Clustering#do","link":"<a href=\"Hierarchical_Clustering.html#do\">Hierarchical_Clustering &rtrif; do</a>"},{"title":"Hierarchical_Clustering#get_clusters","link":"<a href=\"Hierarchical_Clustering.html#get_clusters\">Hierarchical_Clustering &rtrif; get_clusters</a>"},{"title":"Hierarchical_Clustering#init","link":"<a href=\"Hierarchical_Clustering.html#init\">Hierarchical_Clustering &rtrif; init</a>"},{"title":"HIPP","link":"<a href=\"HIPP.html\">HIPP</a>"},{"title":"HIPP#parameter","link":"<a href=\"HIPP.html#parameter\">HIPP &rtrif; parameter</a>"},{"title":"HIPP#transform","link":"<a href=\"HIPP.html#transform\">HIPP &rtrif; transform</a>"},{"title":"HNSW","link":"<a href=\"HNSW.html\">HNSW</a>"},{"title":"HNSW#add","link":"<a href=\"HNSW.html#add\">HNSW &rtrif; add</a>"},{"title":"HNSW#search","link":"<a href=\"HNSW.html#search\">HNSW &rtrif; search</a>"},{"title":"HNSW#search_iter","link":"<a href=\"HNSW.html#search_iter\">HNSW &rtrif; search_iter</a>"},{"title":"ISOMAP","link":"<a href=\"ISOMAP.html\">ISOMAP</a>"},{"title":"ISOMAP#parameter","link":"<a href=\"ISOMAP.html#parameter\">ISOMAP &rtrif; parameter</a>"},{"title":"ISOMAP#transform","link":"<a href=\"ISOMAP.html#transform\">ISOMAP &rtrif; transform</a>"},{"title":"KMeans","link":"<a href=\"KMeans.html\">KMeans</a>"},{"title":"KMeans#get_clusters","link":"<a href=\"KMeans.html#get_clusters\">KMeans &rtrif; get_clusters</a>"},{"title":"KMeans#init","link":"<a href=\"KMeans.html#init\">KMeans &rtrif; init</a>"},{"title":"KMedoids","link":"<a href=\"KMedoids.html\">KMedoids</a>"},{"title":"KMedoids#_get_random_medoids","link":"<a href=\"KMedoids.html#_get_random_medoids\">KMedoids &rtrif; _get_random_medoids</a>"},{"title":"KMedoids#_iteration","link":"<a href=\"KMedoids.html#_iteration\">KMedoids &rtrif; _iteration</a>"},{"title":"KMedoids#get_clusters","link":"<a href=\"KMedoids.html#get_clusters\">KMedoids &rtrif; get_clusters</a>"},{"title":"KMedoids#init","link":"<a href=\"KMedoids.html#init\">KMedoids &rtrif; init</a>"},{"title":"KNN","link":"<a href=\"KNN.html\">KNN</a>"},{"title":"KNN#search","link":"<a href=\"KNN.html#search\">KNN &rtrif; search</a>"},{"title":"LDA","link":"<a href=\"LDA.html\">LDA</a>"},{"title":"LDA#parameter","link":"<a href=\"LDA.html#parameter\">LDA &rtrif; parameter</a>"},{"title":"LDA#transform","link":"<a href=\"LDA.html#transform\">LDA &rtrif; transform</a>"},{"title":"LLE","link":"<a href=\"LLE.html\">LLE</a>"},{"title":"LLE#parameter","link":"<a href=\"LLE.html#parameter\">LLE &rtrif; parameter</a>"},{"title":"LLE#transform","link":"<a href=\"LLE.html#transform\">LLE &rtrif; transform</a>"},{"title":"LSP","link":"<a href=\"LSP.html\">LSP</a>"},{"title":"LSP#init","link":"<a href=\"LSP.html#init\">LSP &rtrif; init</a>"},{"title":"LSP#parameter","link":"<a href=\"LSP.html#parameter\">LSP &rtrif; parameter</a>"},{"title":"LSP#transform","link":"<a href=\"LSP.html#transform\">LSP &rtrif; transform</a>"},{"title":"LTSA","link":"<a href=\"LTSA.html\">LTSA</a>"},{"title":"LTSA#parameter","link":"<a href=\"LTSA.html#parameter\">LTSA &rtrif; parameter</a>"},{"title":"LTSA#transform","link":"<a href=\"LTSA.html#transform\">LTSA &rtrif; transform</a>"},{"title":"Matrix","link":"<a href=\"Matrix.html\">Matrix</a>"},{"title":"Matrix.det","link":"<a href=\"Matrix.html#.det\">Matrix.det &rtrif; undefined</a>"},{"title":"Matrix.from","link":"<a href=\"Matrix.html#.from\">Matrix.from &rtrif; undefined</a>"},{"title":"Matrix.LU","link":"<a href=\"Matrix.html#.LU\">Matrix.LU &rtrif; undefined</a>"},{"title":"Matrix.solve","link":"<a href=\"Matrix.html#.solve\">Matrix.solve &rtrif; undefined</a>"},{"title":"Matrix.solve_CG","link":"<a href=\"Matrix.html#.solve_CG\">Matrix.solve_CG &rtrif; undefined</a>"},{"title":"Matrix.SVD","link":"<a href=\"Matrix.html#.SVD\">Matrix.SVD &rtrif; undefined</a>"},{"title":"Matrix#add","link":"<a href=\"Matrix.html#add\">Matrix &rtrif; add</a>"},{"title":"Matrix#clone","link":"<a href=\"Matrix.html#clone\">Matrix &rtrif; clone</a>"},{"title":"Matrix#col","link":"<a href=\"Matrix.html#col\">Matrix &rtrif; col</a>"},{"title":"Matrix#concat","link":"<a href=\"Matrix.html#concat\">Matrix &rtrif; concat</a>"},{"title":"Matrix#divide","link":"<a href=\"Matrix.html#divide\">Matrix &rtrif; divide</a>"},{"title":"Matrix#dot","link":"<a href=\"Matrix.html#dot\">Matrix &rtrif; dot</a>"},{"title":"Matrix#entry","link":"<a href=\"Matrix.html#entry\">Matrix &rtrif; entry</a>"},{"title":"Matrix#gather","link":"<a href=\"Matrix.html#gather\">Matrix &rtrif; gather</a>"},{"title":"Matrix#get_block","link":"<a href=\"Matrix.html#get_block\">Matrix &rtrif; get_block</a>"},{"title":"Matrix#inverse","link":"<a href=\"Matrix.html#inverse\">Matrix &rtrif; inverse</a>"},{"title":"Matrix#iterate_rows","link":"<a href=\"Matrix.html#iterate_rows\">Matrix &rtrif; iterate_rows</a>"},{"title":"Matrix#mult","link":"<a href=\"Matrix.html#mult\">Matrix &rtrif; mult</a>"},{"title":"Matrix#outer","link":"<a href=\"Matrix.html#outer\">Matrix &rtrif; outer</a>"},{"title":"Matrix#row","link":"<a href=\"Matrix.html#row\">Matrix &rtrif; row</a>"},{"title":"Matrix#set_block","link":"<a href=\"Matrix.html#set_block\">Matrix &rtrif; set_block</a>"},{"title":"Matrix#set_entry","link":"<a href=\"Matrix.html#set_entry\">Matrix &rtrif; set_entry</a>"},{"title":"Matrix#set_row","link":"<a href=\"Matrix.html#set_row\">Matrix &rtrif; set_row</a>"},{"title":"Matrix#sub","link":"<a href=\"Matrix.html#sub\">Matrix &rtrif; sub</a>"},{"title":"Matrix#transpose","link":"<a href=\"Matrix.html#transpose\">Matrix &rtrif; transpose</a>"},{"title":"MDS","link":"<a href=\"MDS.html\">MDS</a>"},{"title":"MDS#parameter","link":"<a href=\"MDS.html#parameter\">MDS &rtrif; parameter</a>"},{"title":"MDS#stress","link":"<a href=\"MDS.html#stress\">MDS &rtrif; stress</a>"},{"title":"MDS#transform","link":"<a href=\"MDS.html#transform\">MDS &rtrif; transform</a>"},{"title":"NNDescent","link":"<a href=\"NNDescent.html\">NNDescent</a>"},{"title":"NNDescent#add","link":"<a href=\"NNDescent.html#add\">NNDescent &rtrif; add</a>"},{"title":"NNDescent#search","link":"<a href=\"NNDescent.html#search\">NNDescent &rtrif; search</a>"},{"title":"OAP","link":"<a href=\"OAP.html\">OAP</a>"},{"title":"OPTICS","link":"<a href=\"OPTICS.html\">OPTICS</a>"},{"title":"OPTICS#get_cluster_affirmation","link":"<a href=\"OPTICS.html#get_cluster_affirmation\">OPTICS &rtrif; get_cluster_affirmation</a>"},{"title":"OPTICS#get_clusters","link":"<a href=\"OPTICS.html#get_clusters\">OPTICS &rtrif; get_clusters</a>"},{"title":"OPTICS#init","link":"<a href=\"OPTICS.html#init\">OPTICS &rtrif; init</a>"},{"title":"PCA","link":"<a href=\"PCA.html\">PCA</a>"},{"title":"PCA#parameter","link":"<a href=\"PCA.html#parameter\">PCA &rtrif; parameter</a>"},{"title":"PCA#principal_components","link":"<a href=\"PCA.html#principal_components\">PCA &rtrif; principal_components</a>"},{"title":"PCA#transform","link":"<a href=\"PCA.html#transform\">PCA &rtrif; transform</a>"},{"title":"Randomizer","link":"<a href=\"Randomizer.html\">Randomizer</a>"},{"title":"Randomizer.choice","link":"<a href=\"Randomizer.html#.choice\">Randomizer.choice &rtrif; undefined</a>"},{"title":"Randomizer#choice","link":"<a href=\"Randomizer.html#choice\">Randomizer &rtrif; choice</a>"},{"title":"SAMMON","link":"<a href=\"SAMMON.html\">SAMMON</a>"},{"title":"SAMMON#init","link":"<a href=\"SAMMON.html#init\">SAMMON &rtrif; init</a>"},{"title":"SAMMON#parameter","link":"<a href=\"SAMMON.html#parameter\">SAMMON &rtrif; parameter</a>"},{"title":"SAMMON#transform","link":"<a href=\"SAMMON.html#transform\">SAMMON &rtrif; transform</a>"},{"title":"TopoMap","link":"<a href=\"TopoMap.html\">TopoMap</a>"},{"title":"TopoMap#init","link":"<a href=\"TopoMap.html#init\">TopoMap &rtrif; init</a>"},{"title":"TopoMap#parameter","link":"<a href=\"TopoMap.html#parameter\">TopoMap &rtrif; parameter</a>"},{"title":"TopoMap#transform","link":"<a href=\"TopoMap.html#transform\">TopoMap &rtrif; transform</a>"},{"title":"TriMap","link":"<a href=\"TriMap.html\">TriMap</a>"},{"title":"TriMap#_generate_triplets","link":"<a href=\"TriMap.html#_generate_triplets\">TriMap &rtrif; _generate_triplets</a>"},{"title":"TriMap#_grad","link":"<a href=\"TriMap.html#_grad\">TriMap &rtrif; _grad</a>"},{"title":"TriMap#generator","link":"<a href=\"TriMap.html#generator\">TriMap &rtrif; generator</a>"},{"title":"TriMap#init","link":"<a href=\"TriMap.html#init\">TriMap &rtrif; init</a>"},{"title":"TriMap#parameter","link":"<a href=\"TriMap.html#parameter\">TriMap &rtrif; parameter</a>"},{"title":"TriMap#transform","link":"<a href=\"TriMap.html#transform\">TriMap &rtrif; transform</a>"},{"title":"TSNE","link":"<a href=\"TSNE.html\">TSNE</a>"},{"title":"TSNE#generator","link":"<a href=\"TSNE.html#generator\">TSNE &rtrif; generator</a>"},{"title":"TSNE#init","link":"<a href=\"TSNE.html#init\">TSNE &rtrif; init</a>"},{"title":"TSNE#parameter","link":"<a href=\"TSNE.html#parameter\">TSNE &rtrif; parameter</a>"},{"title":"TSNE#transform","link":"<a href=\"TSNE.html#transform\">TSNE &rtrif; transform</a>"},{"title":"UMAP","link":"<a href=\"UMAP.html\">UMAP</a>"},{"title":"UMAP#generator","link":"<a href=\"UMAP.html#generator\">UMAP &rtrif; generator</a>"},{"title":"UMAP#init","link":"<a href=\"UMAP.html#init\">UMAP &rtrif; init</a>"},{"title":"UMAP#parameter","link":"<a href=\"UMAP.html#parameter\">UMAP &rtrif; parameter</a>"},{"title":"UMAP#transform","link":"<a href=\"UMAP.html#transform\">UMAP &rtrif; transform</a>"},{"title":"XMeans","link":"<a href=\"XMeans.html\">XMeans</a>"},{"title":"Eigenpair","link":"<a href=\"global.html#Eigenpair\">Eigenpair</a>"}];
        var options = 
          setupSearch(list, options)
      </script>
    

    

    

    


  </body>

</html>
